sudo: required
dist: xenial
env:
  matrix:
  - MOZ_HEADLESS=1
  global:
    secure: GN9reUXYxqFOKTKbGCDV9fxeDQK7oFExdDaFl+ouRveI8p99b/KJPRs8n7ppXoGwBw30NRkxLUu3cu9yHdcypkuXQQTjeOlhHNfIA/BCFo5piZt/7MjvQ5PK1wL/An7BpoXlhuHFhBoOo2bsXcm+sjuV6QKUYtRViy6ymoj1/ITEy4tYSjxlK+XTO5JPDGac31AOVE07VgWX5ZxtuU/gKKgBPKxDujGlreKuh6+a1EwANCrh1NaYtVmurHpIzV633k+ji7f/gDrQxRP8DbfiNfwh6XW0Ht54tXJ2GaIllN+mCrEBVggTZ3rcz7ESSCkszmSy39WhfYhFmqbIOiNjS9UIPQgarqJoe7xbQUjGYjycqXEpVBX/05Inqy9suxpDzTCoLoW/7t4b/ETP3WVzV8Nq1Fs56r6pYOPZdkJ4la9Kxoly9XeY+e2ZgqYxdd92KcICs6J5m63i+yovUKOU204YuJwWzPDlR/xMwHASyQ1Z8+cZo+CFAEIfefjZXbvDM6gWInO6nHyGKowuD0cf0gI82DUum+iD0nXO4N7HnqpsU2A7BQGyHYo7WcAiPOU2PENpU/f4Oz0bbxHqZ9ooHPkoOQJvoHMwl5gwvq7oPlbcNgvxrNuQhXRJ1i7vle7fVFqnGSJQcOhxprkGF8V+xrBhNeLwR2rOExd1JBOGip8=
addons:
  firefox: latest
  apt:
    packages:
    - bsdtar
    - gettext
  chrome: stable
language: python
python:
- '3.5'
before_install:
- wget https://github.com/mozilla/geckodriver/releases/download/v0.24.0/geckodriver-v0.24.0-linux64.tar.gz
- mkdir geckodriver
- tar -xzf geckodriver-v0.24.0-linux64.tar.gz -C geckodriver
- export PATH=$PATH:$PWD/geckodriver
install:
- pip install -r requirements.txt
- python setup.py install
before_script:
- mkdir -p $HOME/.chembl-glados
- cp configurations/default_travis_config.yml $HOME/.chembl-glados/config.yml
- "./manage_glados_no_install.sh makemigrations"
- "./manage_glados_no_install.sh migrate"
- "./manage_glados_no_install.sh compilemessages"
- "./manage_glados_no_install.sh runserver 8000  2>&1 | grep -v 200 | grep -v 304
  &"
- sleep 60
script:
- "./run_tests_no_install.sh"
