sudo: required
dist: xenial
env:
  matrix:
  - MOZ_HEADLESS=1
  - secure: kikcl2yJmUvG1OdQ+3gFTEa1Y+1ZOGst6SwuBN1urjPssKh4197qjhe7zzUfIl8YizpdKDNcZXvsFwv96fwkONeF/fcq1BqJdP+OgnW86wlJfFtNQaWk0KJXSuRxEL3xsgDaY2rfR+CB0gnWKgVk0t37LL0Oj0b80R63amD/uQFJQEh1kAP8Uzi9zPi3VFCEj0js49QpMnaifwyaAqMnrRhkHt+KwY8dNvkkiCaU/HZlrbqInkSbgKB7XHeqoW85yeiLu8SmDUgZwtWmF209KtMAV27DNToFYnEvS43QRD76D+l1Stgu3FH8i+6WCw5sYJNBnurYRAl1XBYytubVWrKti5DHXBR5jggIaZ3amuGqXpdUMSDIjW6IgpnL3exnhPXcb8kyJNQzT5EipsUfZb+TqLr+hTMvtR45cDKELFNXvhPlxONBNPjN7EvNNynteTZ6ukflvDb98tehADsXlEku7LCb42GoKXcSYBsMuMMDq9jsP3vMMPjl9YQyL2EkDRrx0Bb9Fk7p87Qpox6HSQHKH3CemjwHV2FpVjZBSpRDM8WLY4O9b16nnkehihnR711KwpQhveWOS4u2SaWU+qDffghB6lDV9OUnxAOUx1yvyePfHnAhvjWdUSjS7vGuV0G8sxv4fUcfZhNCWsdUJ2CC8DQpCp0wQ7qxhZEF9Kc=
  - secure: HTW/a3m2L3TZDOLUQcHRpVUwDg8Rak4z1kMks4ugomr1A6cst6ISOJLQcXy+5XtMUZ8DuZPz38G2ejgOw5Av3Vzh4KtT6wm4rAjI4w7vwLbx18/j/wF9DeE1jP86yqPod2pETC97qbp4d3Gk41PcYT8cAkpe5KMr+oICK2IEWjgXyQwfGqjzA3QIgwyJ1lLUhlUwd9JtkShEKBMIkRZiA1QWvWk88E7AsZ6aHkonndgy/Rr+D2hwx8cQchdupgK4cKaXk7vuizLkGnl8VXV3BjUi8ZGni4NV4UlP0RJnqocbTEz5ujWvjDw2Wv14YQf5llGnSYxq3OS0VCKafulrdmGtBXEYIW7AuyrEDkJ11krZR53+y1132q10Tf0szn7KAj0s5wci5v5t/DsBCIOy3E+Sg7e20yqVebInAlAg1WxLpUKX3VmQPdBvs/8/Rvk+CiXp1TjVCBnaEgd9pdDRzz52ioWePROsfD2Yg3I9xapNksdnYqOJovHNXrSTxqo2swmZK0Qn01GHUd7jw9B7p6XdSch6Iw2COsRi8L4VKg1NPjaL5zwFo8oqhMZajEnuK6Pty2kGrrozYVn2At2QFhMUM4DHdGrf+GihPAqoW0OaFYWXAMzQeCxSseB8aBZMilr+/2x877IOaZq6p6thrBsTfsgacgoJj4VkGzj3JNs=
addons:
  firefox: latest
  apt:
    packages:
    - bsdtar
    - gettext
  chrome: stable
language: python
python:
- '3.5'
before_install:
- wget https://github.com/mozilla/geckodriver/releases/download/v0.24.0/geckodriver-v0.24.0-linux64.tar.gz
- mkdir geckodriver
- tar -xzf geckodriver-v0.24.0-linux64.tar.gz -C geckodriver
- export PATH=$PATH:$PWD/geckodriver
install:
- pip install -r requirements.txt
- python setup.py install
before_script:
- mkdir -p $HOME/.chembl-glados
- cp configurations/default_travis_config.yml $HOME/.chembl-glados/config.yml
- "./manage_glados_no_install.sh makemigrations"
- "./manage_glados_no_install.sh migrate"
- "./manage_glados_no_install.sh compilemessages"
- "./manage_glados_no_install.sh runserver 8000  2>&1 | grep -v 200 | grep -v 304
  &"
- sleep 60
script:
- "./run_tests_no_install.sh"
