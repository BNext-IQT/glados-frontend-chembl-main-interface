// Generated by CoffeeScript 1.4.0
var contract, expand, hideExpandableMenu, hideExpandableMenuWrapper, initCroppedContainers, initExpendableMenus, setLessText, setMoreText, showExpandableMenu, toggleCroppedContainerWrapper, toggleExpandableMenuWrapper;

expand = function(elem) {
  elem.removeClass("cropped");
  return elem.addClass("expanded");
};

contract = function(elem) {
  elem.removeClass("expanded");
  return elem.addClass("cropped");
};

setMoreText = function(elem) {
  var icon;
  icon = $(elem).children('i');
  icon.removeClass('fa-caret-up');
  return icon.addClass('fa-caret-down');
};

setLessText = function(elem) {
  var icon;
  icon = $(elem).children('i');
  icon.removeClass('fa-caret-down');
  return icon.addClass('fa-caret-up');
};

/* *
  * @param {JQuery} elem element that is going to be toggled
  * @param {JQuery} buttons element that contains the buttons that activate this..
  * @return {Function} function that toggles the cropped container
*/


toggleCroppedContainerWrapper = function(elem, buttons) {
  var toggleCroppedContainer;
  toggleCroppedContainer = function() {
    if (elem.hasClass("expanded")) {
      contract(elem);
      setMoreText($(this));
      return buttons.removeClass('cropped-container-btns-exp');
    } else {
      expand(elem);
      setLessText($(this));
      return buttons.addClass('cropped-container-btns-exp');
    }
  };
  return toggleCroppedContainer;
};

/* *
  * Initializes the cropped container on the elements of the class 'cropped-container'
*/


initCroppedContainers = function() {
  return $('.cropped-container').each(function() {
    var activated, activator, buttons, heightLimit, overflow, toggler;
    activator = $(this).find('a[data-activates]');
    activated = $('#' + activator.attr('data-activates'));
    buttons = $(this).find('.cropped-container-btns');
    overflow = false;
    heightLimit = activated.offset().top + activated.height();
    activated.children().each(function() {
      var childHeightLimit;
      childHeightLimit = $(this).offset().top + $(this).height();
      if (childHeightLimit > heightLimit) {
        overflow = true;
        return false;
      }
    });
    if (overflow) {
      toggler = toggleCroppedContainerWrapper(activated, buttons);
      return activator.click(toggler);
    } else {
      return activator.hide();
    }
  });
};

showExpandableMenu = function(activator, elem) {
  activator.html('<i class="material-icons">remove</i>');
  return elem.slideDown(300);
};

hideExpandableMenu = function(activator, elem) {
  activator.html('<i class="material-icons">add</i>');
  return elem.slideUp(300);
};

hideExpandableMenuWrapper = function(activator, elem_id_list) {
  var toggleExpandableMenu;
  toggleExpandableMenu = function() {
    return $.each(elem_id_list, function(index, elem_id) {
      var elem;
      elem = $('#' + elem_id);
      return hideExpandableMenu(activator, elem);
    });
  };
  return toggleExpandableMenu;
};

/* *
* @param {JQuery} activator element that activates toggles the expandable menu
  * @param {Array} elem_id_list list of menu elements that are going to be shown
  * @return {Function} function that toggles the expandable menus
*/


toggleExpandableMenuWrapper = function(activator, elem_id_list) {
  var toggleExpandableMenu;
  toggleExpandableMenu = function() {
    return $.each(elem_id_list, function(index, elem_id) {
      var elem;
      elem = $('#' + elem_id);
      if (elem.css('display') === 'none') {
        return showExpandableMenu(activator, elem);
      } else {
        return hideExpandableMenu(activator, elem);
      }
    });
  };
  return toggleExpandableMenu;
};

/* *
  *  Initializes the cropped container on the elements of the class 'expandable-menu'
*/


initExpendableMenus = function() {
  return $('.expandable-menu').each(function() {
    var activators, currentDiv;
    currentDiv = $(this);
    activators = $(this).find('a[data-activates]');
    return activators.each(function() {
      var activated_list, activated_list_selectors, activator, hider, toggler;
      activator = $(this);
      activated_list = activator.attr('data-activates').split(',');
      toggler = toggleExpandableMenuWrapper(activator, activated_list);
      activator.click(toggler);
      hider = hideExpandableMenuWrapper(activator, activated_list);
      activated_list_selectors = '';
      $.each(activated_list, function(index, elem_id) {
        return activated_list_selectors += '#' + elem_id + ', ';
      });
      $('body').click(function(e) {
        if (!$.contains(currentDiv[0], e.target)) {
          return hider();
        }
      });
      return activator.click(function(event) {
        return event.stopPropagation();
      });
    });
  });
};
