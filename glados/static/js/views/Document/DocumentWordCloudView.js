// Generated by CoffeeScript 1.4.0
var DocumentWordCloudView;

DocumentWordCloudView = CardView.extend(ResponsiviseViewExt).extend({
  initialize: function() {
    var updateViewProxy;
    return updateViewProxy = this.setUpResponsiveRender();
  },
  render: function() {
    var K, config, desiredMaxWidth, elemID, elemWidth, getColourFor, getFontSizeFor, highestValue, highestValueWords, highestWordLength, maxFontSize, minFontSize, value, word, wordList, wordSize, wordVal, _i, _j, _len, _len1;
    elemID = $(this.el).attr('id');
    elemWidth = $(this.el).width();
    $(this.el).height(elemWidth);
    K = 0.54;
    wordList = [['Number', 24 / 1000], ['7-benzoylbenzofuran-5-ylacetic', 24 / 1000], ['Acid', 48 / 1000], ['Synthesize', 24 / 1000], ['Potent', 24 / 1000], ['Phenylbutazone', 24 / 1000], ['Rat', 48 / 1000], ['Paw', 48 / 1000], ['Antiinflammatory', 24 / 1000], ['Edema', 24 / 1000], ['Assay', 48 / 1000], ['analgetic', 24 / 1000], ['compound', 12 / 1000], ['7-[4-(methylthio)-benzoyl]benzofuran-5-ylacetic', 24 / 1000], ['Aspirin', 24 / 1000], ['Mouse', 96 / 1000], ['Virtually', 12 / 1000], ['Gastric', 96 / 1000], ['Ulceration', 96 / 1000]];
    highestValueWords = [];
    highestValue = 0;
    highestWordLength = 0;
    for (_i = 0, _len = wordList.length; _i < _len; _i++) {
      wordVal = wordList[_i];
      word = wordVal[0];
      wordSize = word.length;
      value = wordVal[1];
      if (value > highestValue) {
        highestValue = value;
        highestValueWords = [];
        highestValueWords.push(word);
        highestWordLength = wordSize;
      } else if (value === highestValue) {
        highestValueWords.push(word);
        if (wordSize > highestWordLength) {
          highestWordLength = wordSize;
        }
      }
    }
    desiredMaxWidth = 0.5 * elemWidth;
    maxFontSize = parseInt(desiredMaxWidth / (K * highestWordLength));
    minFontSize = 10;
    getFontSizeFor = d3.scale.linear().domain([0, highestValue]).range([minFontSize, maxFontSize]).clamp(true);
    getColourFor = d3.scale.linear().domain([minFontSize, maxFontSize]).interpolate(d3.interpolateHcl).range([d3.rgb(Settings.VISUALISATION_RED_MIN), d3.rgb(Settings.VISUALISATION_RED_MAX)]);
    for (_j = 0, _len1 = wordList.length; _j < _len1; _j++) {
      wordVal = wordList[_j];
      wordVal[1] = getFontSizeFor(wordVal[1]);
    }
    console.log(wordList);
    config = {
      list: wordList,
      fontFamily: "Roboto Mono",
      drawOutOfBound: true,
      color: function(word, fontSize) {
        return getColourFor(fontSize);
      },
      rotateRatio: 0.0
    };
    return WordCloud(document.getElementById(elemID), config);
  }
});
