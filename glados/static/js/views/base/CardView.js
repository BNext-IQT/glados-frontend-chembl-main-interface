// Generated by CoffeeScript 1.4.0
var CardView;

CardView = Backbone.View.extend({
  showCompoundErrorCard: function(model, xhr, options) {
    var error_msg, rendered;
    $(this.el).children('.card-preolader-to-hide').hide();
    if (xhr.status === 404) {
      error_msg = 'No compound found with id ' + this.model.get('molecule_chembl_id');
    } else {
      error_msg = 'There was an error while loading the compound (' + xhr.status + ' ' + xhr.statusText + ')';
    }
    rendered = Handlebars.compile($('#Handlebars-Common-CardError').html())({
      msg: error_msg
    });
    $(this.el).children('.card-load-error').find('.Bck-errormsg').html(rendered);
    $(this.el).children('.card-load-error').show();
    return $(this.el).find('#Bck-CHEMBL_ID');
  },
  initEmbedModal: function(section_name) {
    var modal, modal_id, modal_trigger;
    if (typeof EMBEDED !== "undefined" && EMBEDED !== null) {
      $(this.el).find('.embed-modal-trigger').remove();
      $(this.el).find('.embed-modal').remove();
      return;
    }
    modal_trigger = $(this.el).find('.embed-modal-trigger');
    modal = $(this.el).find('.embed-modal');
    modal_id = 'embed-modal-for-' + $(this.el).attr('id');
    modal.attr('id', modal_id);
    modal_trigger.attr('href', '#' + modal_id);
    modal_trigger.attr('rendered', 'false');
    modal_trigger.attr('data-embed-sect-name', section_name);
    return modal_trigger.click(this.renderModalPreview);
  },
  renderModalPreview: function() {
    var chembl_id, clicked, code_elem, code_to_preview, modal, preview_elem, rendered, section_name;
    clicked = $(this);
    if (clicked.attr('rendered') === 'true') {
      return;
    }
    section_name = clicked.attr('data-embed-sect-name');
    modal = $(clicked.attr('href'));
    code_elem = modal.find('code');
    chembl_id = this.model != null ? this.model.get('molecule_chembl_id') : CHEMBL_ID;
    rendered = Handlebars.compile($('#Handlebars-Common-EmbedCode').html())({
      chembl_id: chembl_id,
      section_name: section_name
    });
    code_elem.text(rendered);
    preview_elem = modal.find('.embed-preview');
    code_elem = modal.find('code');
    code_to_preview = code_elem.text();
    preview_elem.html(code_to_preview);
    return clicked.attr('rendered', 'true');
  },
  activateTooltips: function() {
    return $(this.el).find('.tooltipped').tooltip();
  },
  activateModals: function() {
    return $(this.el).find('.modal-trigger').leanModal();
  },
  showVisibleContent: function() {
    $(this.el).children('.card-preolader-to-hide').hide();
    return $(this.el).children(':not(.card-preolader-to-hide, .card-load-error, .modal)').show();
  }
});
