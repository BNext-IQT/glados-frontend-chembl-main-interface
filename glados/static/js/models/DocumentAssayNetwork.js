// Generated by CoffeeScript 1.4.0
var DocumentAssayNetwork;

DocumentAssayNetwork = Backbone.Model.extend({
  fetch: function() {
    var assaysUrl, docChemblId, triggerAssayRequest;
    docChemblId = this.get('document_chembl_id');
    assaysUrl = 'https://www.ebi.ac.uk/chembl/api/data/assay.json?document_chembl_id=' + docChemblId + '&limit=10';
    triggerAssayRequest = function(currentUrl) {
      var getAssaysGroup;
      getAssaysGroup = $.getJSON(currentUrl, function(response) {
        var newAssays, nextUrl;
        console.log('response!');
        console.log(response);
        newAssays = response.assays;
        nextUrl = response.page_meta.next;
        console.log('Next: ', response.page_meta.next != null);
        console.log('Next url: ', nextUrl);
        if (nextUrl != null) {
          return triggerAssayRequest('https://www.ebi.ac.uk' + nextUrl);
        }
      });
      return getAssaysGroup.fail(function() {
        return console.log('FAILED!');
      });
    };
    return triggerAssayRequest(assaysUrl);
  }
});
